<!doctype html>
<html lang="ar" dir="ltr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Fares AI</title>
<style>
  :root{
    --bg:#040404;
    --panel:#0b0b0b;
    --blood:#c0574b;        /* Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø¯Ù…ÙˆÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯ */
    --blood-glow: rgba(192,87,75,0.22);
    --muted:#9aa0a6;
    --glass: rgba(255,255,255,0.03);
    --radius:14px;
    --accent:#ff5a5a;
    font-family: "Segoe UI", Tahoma, Arial, sans-serif;
  }
  html, body {
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: #eee;
  height: auto !important;
  min-height: 100%;
  overflow-x: hidden;
  overflow-y: auto !important;
}
.app.hidden {
    display: none !important;
    opacity: 0;
}
  /* SPLASH 1 (loading) */
  .splash1 {
    position:fixed;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;
    background:radial-gradient(circle at 50% 30%, rgba(192,87,75,0.03), #040404 60%);
    z-index:99999;transition:opacity .45s ease, transform .45s ease;
  }
  .splash1 .aiBox{
    width:160px;height:160px;border-radius:28px;
    background:linear-gradient(180deg,#0b0b0b,#060606);
    border:4px solid var(--blood-glow);
    display:flex;align-items:center;justify-content:center;
    box-shadow:0 12px 50px rgba(192,87,75,0.06), inset 0 6px 30px rgba(0,0,0,0.6);
  }
  .splash1 .aiText{font-weight:900;color:var(--blood);font-size:48px;letter-spacing:2px;text-shadow:0 0 14px rgba(192,87,75,0.28)}
  .splash1 h2{margin:18px 0 6px;font-size:22px;color:#fff}
  .splash1 p{margin:0;color:var(--muted);font-size:13px}
  .loaderRing{margin-top:18px;width:64px;height:64px;border-radius:50%;border:6px solid rgba(255,255,255,0.04);border-top-color:var(--blood);animation:spin 1s linear infinite;box-shadow:0 6px 30px rgba(192,87,75,0.06)}
  @keyframes spin{to{transform:rotate(360deg)}}

  /* SPLASH 2 (fingerprint hold) */
  .splash2 {
    position:fixed;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;
    background:linear-gradient(180deg,#080404 0%, #0b0606 60%);
    z-index:99990;opacity:0;visibility:hidden;transition:opacity .35s ease;
  }
  .splash2.visible{opacity:1;visibility:visible}
  .fpCircle{width:160px;height:160px;border-radius:50%;background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.03), rgba(255,255,255,0.01));display:flex;align-items:center;justify-content:center;border:3px solid rgba(255,255,255,0.03);box-shadow:0 10px 40px rgba(192,87,75,0.06), inset 0 10px 30px rgba(0,0,0,0.6)}
  .fpIcon{width:86px;height:86px;background:transparent;border-radius:50%;display:flex;align-items:center;justify-content:center;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="86" height="86" viewBox="0 0 24 24"><path fill="%23ffffff" d="M12 2C8.686 2 6 4.239 6 7.2V9c0 3 1.333 5.268 3.333 6.8C10.667 16.532 12 18.8 12 21.8v.4c.667 0 1.333-.533 1.333-.533S13.333 20 14 20c0-3 1.333-5.268 3.333-6.8C19.667 14.268 21 12 21 9V7.2C21 4.239 18.314 2 15 2h-3z"/></svg>');background-repeat:no-repeat;background-position:center;background-size:60%;opacity:0.95;filter:drop-shadow(0 6px 12px rgba(192,87,75,0.12))}
  .fpLabel{margin-top:18px;color:#fff;font-weight:800;letter-spacing:2px}
  .fpSub{margin-top:6px;color:var(--muted);font-size:13px}
  .holdArea{margin-top:24px;display:flex;align-items:center;flex-direction:column;gap:8px}
  .holdMeter{width:220px;height:56px;border-radius:12px;border:2px solid rgba(192,87,75,0.18);background:linear-gradient(180deg, rgba(192,87,75,0.06), rgba(192,87,75,0.02));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;position:relative;overflow:hidden}
  .holdMeter .bar{position:absolute;left:0;top:0;height:100%;width:0%;background:linear-gradient(90deg,var(--blood),#ff8a7a);transition:width .05s linear}

  /* APP layout */
  .app {
  display: flex;
  width: 100%;
  min-height: 100vh;
  flex-direction: column;
  position: relative;
  overflow-x: hidden;   /* ÙŠÙ…Ù†Ø¹ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„ÙŠØ³Ø§Ø± */
}
.sidebar {
  position: fixed;
  top: 0;
  left: 0;                 /* Ù…Ù‡Ù…: Ù†Ø±Ø¬Ø¹ÙˆÙ‡Ø§ ØµÙØ± */
  width: 280px;
  height: 100%;
  background: #0b0b0b;
  transform: translateX(-100%);  /* Ù†Ø®Ø¨ÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© */
  transition: transform .35s ease;
  z-index: 9999;
  display: flex;
    flex-direction: column;
}

.sidebar.open {
  transform: translateX(0);      /* Ù†Ø®Ø±Ø¬ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© */
}



.menuOverlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.55);
  backdrop-filter: blur(3px);
  display: none;
  z-index: 9998;
}
.menuOverlay.show {
  display: block;
}
  .logo{display:flex;align-items:center;gap:10px}
  .logo .square{width:56px;height:56px;border-radius:12px;border:2px solid var(--blood);display:flex;align-items:center;justify-content:center;color:var(--blood);font-weight:900;background:#0b0b0b;font-size:20px}
  .logo h1{margin:0;color:var(--blood);font-size:18px}
  .status{font-size:12px;color:var(--muted)}
  .menu{display:flex;flex-direction:column;gap:10px;margin-top:10px}
  .menu button{background:transparent;border:1px solid rgba(255,255,255,0.02);color:#ddd;padding:12px;border-radius:10px;text-align:right;cursor:pointer;font-size:15px}
  .menu button.active{background:rgba(192,87,75,0.06);border-color:rgba(192,87,75,0.12);color:#fff;box-shadow:inset 0 4px 18px rgba(192,87,75,0.03)}
  .meta{margin-top:auto;font-size:12px;color:var(--muted);text-align:right;padding-top:6px}

  .main{flex:1;display:flex;flex-direction:column}
  .main {
  max-width: 900px;
  margin: 0 auto;
  width: 100%;
}
  .chatArea {
  max-width: 900px;
  width: 100%;
  margin: 0 auto;   /* Ù‡Ø°Ø§ Ù„ÙŠ ÙŠØ±Ø¬Ù‘Ø¹ Ù„ÙƒÙ„Ø´ÙŠ Ù„Ù„ÙˆØ³Ø· */
  display: flex;
  flex-direction: column;
  flex: 1;
  overflow: visible;
  direction: ltr !important;
}
  .topbar{height:62px;background:#060606;border-bottom:1px solid rgba(192,87,75,0.04);display:flex;align-items:center;justify-content:space-between;padding:0 18px}
  .title{color:var(--blood);font-weight:700;letter-spacing:1px}
  .messages{
  flex:1;
  overflow-y:auto;
  overflow-x:hidden;    /* Ù…Ù‡Ù… â€” ÙŠÙ…Ù†Ø¹ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù„Ù„ÙŠØ³Ø§Ø± */
  padding:20px;
  display:flex;
  flex-direction:column;
  gap:18px;
   align-items:center;/* ÙŠØ®Ù„ÙŠ ÙƒÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ØªØ¯ÙŠ Ø§Ù„Ø·ÙˆÙ„ ÙƒØ§Ù…Ù„ */   /* ÙŠØ®Ù„ÙŠ ÙƒÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙÙŠ Ø§Ù„ÙˆØ³Ø· */
}
.messages { direction: rtl; }
  .note{font-size:13px;color:var(--muted);padding:10px 14px;border-radius:12px;background:linear-gradient(180deg,#12060a,#0b0607);border-left:6px solid var(--blood);max-width:900px}
  .msg.bot {
  font-size: 13px;
  color: var(--muted);
  padding: 10px 14px;
  border-radius: 12px;
  background: linear-gradient(180deg,#12060a,#0b0607);
  border-left: 6px solid var(--blood);
  width: 100%;
  max-width: 900px;
  line-height: 1.8;
  margin: 12px 0;
}
  .msg{
  width:100%;
  max-width:900px;       /* Ø§Ù„Ø¢Ù† Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ØªÙˆÙ„ÙŠ Ø¨Ø§Ù„Ø·ÙˆÙ„ ÙƒØ§Ù…Ù„ */
  margin:0 auto;
  background:#0c0003;
  border:1px solid rgba(255,255,255,0.02);
  color:#ffdddd;
  font-size:15px;
  line-height:1.7;
  padding:16px;
  border-radius:14px;
  white-space:pre-wrap;
  overflow-wrap:break-word;
}
  .msg.me{
  background:#121212;          /* Ù„ÙˆÙ† Ù…Ø®ØªÙ„Ù */
  border:1px solid #333;       /* Ø¥Ø·Ø§Ø± Ø®ÙÙŠÙ */
  color:#fff;
  padding:12px 14px;
  border-radius:12px;
  margin:6px 0;
  width:max-content;
  max-width:85%;
  align-self:flex-end;         /* ÙŠØ±ÙˆØ­ Ù„Ù„ÙŠÙ…ÙŠÙ† */
  direction:rtl;               /* Ø¹Ø±Ø¨ÙŠ ØµØ­ÙŠØ­ */
}
  .codeCard{background:linear-gradient(180deg,#070506,#0a0606);border:2px solid var(--blood);border-radius:12px;padding:8px;position:relative;overflow:hidden;max-width:100%}
  .codeHeader{display:flex;justify-content:space-between;align-items:center;padding:6px 10px;border-bottom:1px solid rgba(255,255,255,0.02)}
  .copyBtn{background:var(--blood);border:0;color:#fff;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:800;display:inline-flex;align-items:center;gap:8px}
  .langBadge{background:rgba(0,0,0,0.25);padding:6px 10px;border-radius:8px;color:#fff;font-weight:700;font-size:13px;border:1px solid rgba(255,255,255,0.02)}
 .codeArea{
  width:100% !important;
  max-width:100% !important;
  background:#000;
  color:#fff;
  padding:14px;
  border-radius:8px;
  font-family: monospace;
  font-size:14px;
  
  white-space: pre !important;     /* ÙŠØ®Ù„ÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø³Ø·Ø± Ø¨Ø³Ø·Ø± */
  overflow-x: auto !important;     /* ÙŠØ¸Ù‡Ø± Scroll ÙƒÙŠ ÙŠÙƒÙˆÙ† Ø§Ù„ÙƒÙˆØ¯ Ø·ÙˆÙŠÙ„ */
  word-break: normal !important;   /* Ù…Ø§ ÙŠÙƒØ³Ø±Ø´ Ø§Ù„ÙƒÙ„Ù…Ø§Øª */
  direction:ltr !important;
  text-align:left !important;
}
  .toolbar{display:flex;gap:8px;justify-content:flex-end;margin-top:10px}
  .toolSm{background:transparent;border:1px solid rgba(255,255,255,0.03);color:#fff;padding:6px 8px;border-radius:8px;cursor:pointer}

  .inputBar {
  height: 90px;
  padding: 14px;
  display: flex;
  align-items: center;
  gap: 10px;
  background: #000;
  border-top: 1px solid rgba(255,255,255,0.1);
}

.sendBtn {
  width: 60px;
  height: 60px;
  border-radius: 16px;
  background: #ff003d;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  box-shadow: 0 0 12px rgba(255,0,60,0.4);
}

.inputBar input {
  flex: 1;
  height: 60px;
  border-radius: 14px;
  background: #111;
  border: 1px solid rgba(255,255,255,0.1);
  padding: 0 18px;
  color: white;
  font-size: 17px;
}
  .planeIcon{width:18px;height:18px;display:inline-block;transform:rotate(-20deg)}
/* ÙƒØªØ§Ø¨Ø© ÙÙ‚Ø· ØªØªÙ…ÙˆØ¬ */
.thinking {
  font-size: 18px;
  font-weight: 700;
  color: #ff7b8a;
  letter-spacing: 2px;
  animation: wave 1.8s infinite ease-in-out;
}

/* Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† */
@keyframes wave {
  0%   { opacity: 0.4; transform: translateY(0px); }
  50%  { opacity: 1;   transform: translateY(-3px); }
  100% { opacity: 0.4; transform: translateY(0px); }
}
.glitch-text {
  font-size: 32px;
  font-weight: 900;
  letter-spacing: 2px;
  color: #ff002b;
  position: relative;
  display: inline-block;
  text-transform: uppercase;
  white-space: nowrap;
}

.glitch-text::before,
.glitch-text::after {
  content: attr(data-text);
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  overflow: hidden;
  color: white;
}

.glitch-text::before {
  left: 2px;
  text-shadow: -2px 0 red;
  animation: glitch-anim 1s infinite linear alternate-reverse;
}

.glitch-text::after {
  left: -2px;
  text-shadow: -2px 0 #ff002b;
  animation: glitch-anim2 1s infinite linear alternate-reverse;
}

@keyframes glitch-anim {
  0% { clip-path: inset(0 0 20% 0); }
  20% { clip-path: inset(10% 0 40% 0); }
  40% { clip-path: inset(30% 0 10% 0); }
  60% { clip-path: inset(5% 0 60% 0); }
  80% { clip-path: inset(40% 0 5% 0); }
  100% { clip-path: inset(25% 0 30% 0); }
}

@keyframes glitch-anim2 {
  0% { clip-path: inset(60% 0 0 0); }
  20% { clip-path: inset(40% 0 10% 0); }
  40% { clip-path: inset(5% 0 40% 0); }
  60% { clip-path: inset(30% 0 20% 0); }
  80% { clip-path: inset(10% 0 35% 0); }
  100% { clip-path: inset(0 0 60% 0); }
}
.statValue {
  color: #06d606 !important;     /* Ø£Ø®Ø¶Ø± Ù†ÙØ³ ACTIVE */
  font-weight: 900;
  letter-spacing: 1px;
}
.thinkBox {
  width: 14px;
  height: 14px;
  border-radius: 4px;
  background: #ff0033; /* Ù„ÙˆÙ† Ø£Ø­Ù…Ø± Ù†ÙØ³ Ø«ÙŠÙ…Ùƒ */
  display: inline-block;
  margin-right: 8px;
}
/* ===== ØªØ­Ø³ÙŠÙ† ØªÙ†Ø³ÙŠÙ‚ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¨ÙˆØª ===== */
.msg.bot {
  font-size: 18px !important;       /* ØªÙƒØ¨ÙŠØ± Ø§Ù„Ù†Øµ */
  line-height: 2 !important;        /* Ù…Ø³Ø§ÙØ§Øª Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ø·Ø± */
  color: #f8dede !important;
}

/* Ø¹Ù†Ø§ÙˆÙŠÙ† ØºØ§Ù…Ù‚Ø© Ø¯Ø§Ø®Ù„ Ø±Ø¯Ù‘ Ø§Ù„Ø¨ÙˆØª */
.msg.bot b,
.msg.bot strong,
.msg.bot span[style*="font-weight:800"] {
  font-size: 20px !important;
  font-weight: 900 !important;
  color: #ffffff !important;
  display: block;
  margin-bottom: 6px;
}

/* Ø§Ù„Ù†Ù‚Ø§Ø· (â€¢) ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ */
.msg.bot div {
  white-space: pre-wrap;
}

.msg.bot div:has(> span)::before {
  content: "";
}

.msg.bot div::before {
  content: "";
}

/* Ø³Ø·Ø± ÙŠØ¨Ø¯Ø£ Ø¨Ù€ - ÙŠØªØ­ÙˆÙ‘Ù„ Ù„Ù†Ù‚Ø·Ø© */
.msg.bot div {
  position: relative;
  padding-right: 18px;
}

.msg.bot div:before {
  content: "â€¢";
  position: absolute;
  right: 0;
  top: 3px;
  color: #ff6b6b;
  font-size: 16px;
  font-weight: 900;
  display: none;
}

.msg.bot div:has(> span),
.msg.bot div[style*="font-weight"] {
  padding-right: 0 !important;
}

.msg.bot div:has(> .no-dot)::before {
  display: none !important;
}

/* Ù†Ø­Ø· Ø§Ù„Ù†Ù‚Ø·Ø© ÙÙ‚Ø· Ø¥Ø°Ø§ Ø§Ù„Ø³Ø·Ø± ÙŠØ¨Ø¯Ø£ Ø¨Ù€ "-" */
.msg.bot div[data-list="true"]::before {
  display: block !important;
}

/* Ù†ÙƒØªØ´Ù Ø§Ù„Ø³Ø·ÙˆØ± Ù„ÙŠ ØªØ¨Ø¯Ø£ Ø¨Ù€ "-" */
.msg.bot div:empty { display:none; }
.title1, .title2, .title3 {
  display: block;
  font-weight: 900;
  color: #fff;
  margin: 12px 0 6px;
  padding: 6px 0;
}

.title1 {
  font-size: 28px;
  border-bottom: 2px solid #ff5a5a;
}

.title2 {
  font-size: 23px;
  border-bottom: 2px solid #c0574b;
}

.title3 {
  font-size: 20px;
  color: #ff9f9f;
}
/* === Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ === */
.msg {
  animation: fadeSlide .35s ease forwards;
  opacity: 0;
}

@keyframes fadeSlide {
  0% { opacity: 0; transform: translateY(10px); }
  100% { opacity: 1; transform: translateY(0); }
}
/* === Ù†Ø¨Ø¶ Ø§Ø­ØªØ±Ø§ÙÙŠ Ù„Ù€ THINKING === */
.thinking {
  animation: pulseThinking 1.2s infinite ease-in-out;
  letter-spacing: 3px;
}

@keyframes pulseThinking {
  0%   { opacity: .4; transform: scale(0.97); }
  50%  { opacity: 1;   transform: scale(1); }
  100% { opacity: .4; transform: scale(0.97); }
}
/* === ØªÙˆÙ‡Ù‘Ø¬ Ø§Ø­ØªØ±Ø§ÙÙŠ Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¨ÙˆØª === */
.msg.bot {
  position: relative;
}

.msg.bot::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 14px;
  box-shadow: 0 0 18px rgba(255, 0, 60, 0.15);
  pointer-events: none;
  z-index: -1;
}
</style>
</head>
<body>

<!-- SPLASH 1 -->
<div class="splash1" id="splash1" aria-hidden="false">
  <div class="aiBox"><div class="aiText">AI</div></div>
  <h2>Lucifer AI</h2>
  <p>Welcome to Lucifer System</p>
  <div class="loaderRing" aria-hidden="true"></div>
</div>

<!-- SPLASH 2 (Fingerprint HOLD) -->
<div class="splash2" id="splash2" aria-hidden="true">
  <div class="fpCircle" id="fpCircle"><div class="fpIcon" id="fpIcon" aria-hidden="true"></div></div>
  <div class="fpLabel center">HOLD TO ACCESS</div>
  <div class="fpSub center">Ø§Ø¶ØºØ· Ù…Ø·ÙˆÙ„Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ØµÙ…Ø© Ù„Ù„Ø¯Ø®ÙˆÙ„</div>
  <div class="holdArea">
    <div class="holdMeter" id="holdMeter">
      <div class="bar" id="holdBar" style="width:0%"></div>
      <div style="position:relative;z-index:2;color:#fff;font-weight:800">Ù…ÙˆØ§ØµÙ„Ø© Ø§Ù„Ø¶ØºØ·...</div>
    </div>
  </div>
</div>

<!-- APP -->
<div class="app hidden" id="app" aria-hidden="true">
  <aside class="sidebar" id="sidebar">

  <div style="padding:20px">
    <h2 class="glitch-text" data-text="FARES DEV">FARES DEV</h2>
    <div style="height:2px;background:#333;margin:10px 0 20px"></div>

    <div style="display:flex;justify-content:space-between;color:#aaa;font-size:14px;margin-bottom:8px">
      <span id="ramUsage" class="statValue">0 KB</span>
<span>RAM</span>
    </div>
    <div style="height:1px;background:#333;margin-bottom:15px"></div>

    <div style="display:flex;justify-content:space-between;color:#aaa;font-size:14px;margin-bottom:8px">
  <span id="timeCounter" class="statValue">00:00:00</span>
<span>TIME</span>
</div>
    <div style="height:1px;background:#333;margin-bottom:15px"></div>

    <div style="display:flex;justify-content:space-between;color:#aaa;font-size:14px;margin-bottom:8px">
      <span style="color:#06d606;font-weight:900">ACTIVE</span>
      <span>SECURE</span>
    </div>
    <div style="height:1px;background:#333;margin-bottom:35px"></div>
  </div>

  <!-- Ø£Ø²Ø±Ø§Ø± ØªØ­Øª -->
  <div style="margin-top:auto;padding:20px">

    <button id="downloadChatBtn" style="
  width: 100%;
  padding: 16px;
  border: 1px solid #333;
  background: transparent;
  color: white;
  border-radius: 10px;
  font-size: 16px;
  display: block;        /* Ù…Ù‡Ù… */
  margin-top: auto;      /* ÙŠØ®Ù„ÙŠÙ‡ ÙŠÙ‡Ø¨Ø· Ù„Ù„Ù‚Ø§Ø¹ */
">
  â¬‡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
</button>

    <button id="clearChatBtn" style="
  margin-top:12px;width:100%;padding:16px;border:1px solid #333;
  background:transparent;color:white;border-radius:10px;
  font-size:16px;display:flex;align-items:center;gap:12px;
">
  ğŸ—‘ Ù…Ø³Ø­ Ø§Ù„Ø°Ø§ÙƒØ±Ø©
</button>

  </div>

</aside>
  <div id="menuOverlay" class="menuOverlay"></div>

  <main class="main">
    <div class="topbar">
      <div class="title">Lucifer AI v1.0</div>
      <div class="right">
        <button class="toolSm" id="openMenuBtn">â˜°</button>
      </div>
    </div>

    <section class="chatArea" role="main">
      <div class="messages" id="messages" role="log" aria-live="polite">
        <div class="note">.SYSTEM ONLINE<br>Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…. Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©.
Ø¬Ø±Ø¨ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª: *Ù…Ø§Ø¦Ù„*ØŒ ~~Ù…Ø´Ø·ÙˆØ¨~~ØŒ ||ØªØ´ÙˆÙŠØ´||.
Ø£Ùˆ Ø§Ø·Ù„Ø¨ ÙƒÙˆØ¯Ø§Ù‹ Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹ Ù„ØªØ±Ù‰ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯! ğŸ˜ˆ</div>
      </div>

      <div style="flex:0 0 auto" class="inputBar">
        <input id="messageInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." autocomplete="off" />
        <button class="sendBtn" id="sendBtn">
  <svg class="planeIcon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M2 21l21-9L2 3v7l15 2-15 2v7z" fill="#fff"></path>
  </svg>
</button>
      </div>
    </section>
  </main>
</div>

<!-- small entrance sound fallback -->
<audio id="enterSound" preload="auto">
  <source src="data:audio/mp3;base64,//uQZAAAAAAAAAAAA" type="audio/mp3">
</audio>

<script>
/* ============= Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ============= */
const API_BASE = 'https://ahmaedinfo.serv00.net/api/api.php'; // Ø¹Ø¯Ù„ Ø¥Ø°Ø§ Ù„Ø§Ø²Ù…
const API_KEY = 'ahmaedinfo';

/* ============= Splash & HOLD ============= */
document.addEventListener('DOMContentLoaded', () => {
  const splash1 = document.getElementById('splash1');
  const splash2 = document.getElementById('splash2');
  const app = document.getElementById('app');
  const fpCircle = document.getElementById('fpCircle');
  const holdBar = document.getElementById('holdBar');

  // show splash1 then splash2
  setTimeout(()=> {
    splash1.style.opacity = 0;
    setTimeout(()=> { splash1.style.display = 'none'; splash2.classList.add('visible'); },420);
  }, 1400);

  // hold logic
  let progress = 0; let interval = null;
  const STEP = 2.8;
  let soundPlayed = false;
  function startHold(e){
    e && e.preventDefault();
    if(interval) return;

    // === ØµÙˆØª Ø¯Ø®ÙˆÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ù„Ù…Ø³ Ù„Ø£ÙˆÙ„ Ù…Ø±Ø© ===
    if(!soundPlayed){
        try{
            const snd = new Audio('https://cdn.pixabay.com/download/audio/2024/01/03/audio_4f25dfec66.mp3?filename=interface-opening-177777.mp3');
            snd.volume = 1;
            snd.play().catch(()=>{});
        }catch(err){}
        soundPlayed = true;
    }

    interval = setInterval(()=> {
      progress += STEP; 
      if(progress>100) progress=100; 
      holdBar.style.width = progress+'%';

      if(progress >= 100){ 
        clearInterval(interval); 
        interval = null; 
        enterApp(); 
      }
    }, 35);

    if(navigator.vibrate) navigator.vibrate([30]);
}
  function stopHold(e){
    e && e.preventDefault();
    if(interval) clearInterval(interval); interval = null; progress = 0; holdBar.style.width = '0%';
    if(navigator.vibrate) navigator.vibrate(20);
  }
  fpCircle.addEventListener('touchstart', startHold); fpCircle.addEventListener('mousedown', startHold);
  fpCircle.addEventListener('touchend', stopHold); fpCircle.addEventListener('mouseup', stopHold); fpCircle.addEventListener('mouseleave', stopHold);

 function enterApp(){
    if(navigator.vibrate) navigator.vibrate([80,40,80]);

    // === ØµÙˆØª Ø¯Ø®ÙˆÙ„ Ù…Ø®ØµØµ ===
    try{
        const enterSnd = new Audio('https://cdn.pixabay.com/download/audio/2024/01/03/audio_4f25dfec66.mp3?filename=interface-opening-177777.mp3');
        enterSnd.volume = 0.9;
        enterSnd.play().catch(()=>{});
    }catch(e){}

    splash2.style.opacity = 0;

    setTimeout(()=>{
        splash2.style.display='none';
        app.classList.remove('hidden');
        app.style.opacity=1;
        app.style.transform='translateY(0)';
        document.body.style.overflow='auto';
    }, 350);
 }
});



/* ============= Render + Chat ============= */
const messagesEl = document.getElementById('messages');
const inputEl = document.getElementById('messageInput');
const sendBtn = document.getElementById('sendBtn');
// â¬… Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ù† Ø§Ù„Ø°Ø§ÙƒØ±Ø©
const savedHistory = localStorage.getItem("chat_history");
if (savedHistory) {
    messagesEl.innerHTML = savedHistory;
}

/* escape html */
function escapeHtml(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

/* Ø§Ø³Ù…Ø§Ø¡: Ø§Ø­Ù…Ø¯ -> ÙØ§Ø±Ø³ (Ø¹Ø±Ø¨ÙŠ Ùˆ Ù„Ø§ØªÙŠÙ†ÙŠ) */
/* Ø§Ø³Ù…Ø§Ø¡: Ø§Ø­Ù…Ø¯ -> ÙØ§Ø±Ø³ (Ø¹Ø±Ø¨ÙŠ Ùˆ Ù„Ø§ØªÙŠÙ†ÙŠ) */
const namePatterns = [
  /\bAHMAEDINFO\b/gi, /\bAHMEDINFO\b/gi, /\bahmaedinfo\b/gi, /\bahmed\b/gi, /\bAHMED\b/gi,

  /Ø£\s*Ø­\s*Ù…\s*Ø¯\s*[\s\-_\.]*Ø¹Ù…Ø§Ø±Ø©/giu,
  /Ø£Ø­Ù…Ø¯\s*Ø¹Ù…Ø§Ø±Ø©/giu,
  /Ø£Ø­Ù…Ø¯/giu,

  /Ø£Ù…Ø§Ø±Ø§/giu,
  /Ø¹Ù…Ø§Ø±Ø©/giu,
  /Amara/gi
];

function replaceNames(txt){
  let t = String(txt||'');

  // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø¨ÙØ§Ø±Ø³
  for(const r of namePatterns){
    t = t.replace(r, '<span style="font-weight:900">ÙØ§Ø±Ø³</span>');
  }

  // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
  t = t.replace(
    /Ø­ÙŠ\s*5\s*ÙŠÙˆÙ„ÙŠÙˆ[^\.]*16000/gi,
    'Ø­ÙŠ Ø¨Ø±Ù‚ÙˆÙ‚Ø©ØŒ Ø¬ÙŠØ¬Ù„. Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø¨Ø±ÙŠØ¯ÙŠ: 18000'
  );
// âš¡ 1) Ù…Ù†Ø¹ Ø£ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù‚Ø¯ÙŠÙ…Ø©
const oldPatterns = [
  /Ù…Ø­Ù…Ø¯\s+Ø§Ù„Ø´Ø±ÙŠÙ\s+Ø¨Ù„Ø¹Ø§Ù„ÙŠØ§/gi,
  /Ø­ÙŠ\s+Ø§Ù„Ø¨Ø³Ø§ØªÙŠÙ†/gi,
  /Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±\s+Ø§Ù„Ø¹Ø§ØµÙ…Ø©/gi,
  /34\s*Ø¹Ø§Ù…/gi,
  /Ù…Ø¨Ø±Ù…Ø¬ ÙÙŠ Ø´Ø±ÙƒØ© "ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„"/gi,
  /0550\d{5}/gi,
  /m\.sh\.belaalia@tech-dz\.com/gi,
  /Ø§Ù„ÙˆØ§Ø¯ Ø·ÙˆÙ„Ùˆ ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§ 178 Ø³Ù…/gi,
  /Ù„ÙˆÙ† Ø¨Ø´Ø±ØªÙ‡ Ù‚Ù…Ø­ÙŠ/gi,
  /Ù†Ø¸Ø§Ø±Ø© Ø·Ø¨ÙŠØ© Ø³ÙˆØ¯Ø§Ø¡/gi,
  /ÙˆØ´Ù… Ù…ÙƒØªÙˆØ¨ ÙÙŠÙ‡ "Powered by C\+\+"/gi,
  /Ø§Ù„Ø£Ø¨ Ù…ØªÙ‚Ø§Ø¹Ø¯ Ù…Ù† Ø§Ù„Ø¬ÙŠØ´/gi,
  /Ø¹Ø§Ø²Ø¨/gi,
  /Ø¨ÙŠØ¬Ùˆ\s*208/gi,
];

// âœ‚ï¸ Ù†Ø­Ø°Ù ÙƒØ§Ù…Ù„ Ø§Ù„Ù†ØµÙˆØµ Ù‡Ø§Ø°ÙŠ
for(const r of oldPatterns){
  t = t.replace(r, '');
}

// âš¡ 2) Ù†Ø¨Ø¯Ù„ Ø§Ù„Ù†Øµ ÙƒØ§Ù…Ù„ Ø¨Ø§Ù„Ù†Øµ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ØªØ§Ø¹ ÙØ§Ø±Ø³
const newInfo = `
ğŸ“ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©:
- Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„: <span style="font-weight:900">ÙØ§Ø±Ø³ Ø¬Ø§Ø¨Ø±</span>
- Ø§Ù„Ø¹Ù…Ø±: 19 Ø³Ù†Ø©
- Ø§Ù„Ù…Ù‡Ù†Ø©: Ù…Ø¨Ø±Ù…Ø¬ ØªØ·Ø¨ÙŠÙ‚Ø§Øª ÙˆÙ…ÙˆØ§Ù‚Ø¹ ÙˆÙ„Ø§Ù†ØªØ±Ù†Øª Ù…Ø¬Ø§Ù†ÙŠ
- Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: 0793973420 (Ø®Ø§Øµ)
- Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: nafa.fares@gmail.com

ğŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:
ÙŠØ³ÙƒÙ† ÙÙŠ Ø­ÙŠ Ø¬ÙŠØ¬Ù„ØŒ Ø±Ù‚Ù… 18ØŒ ÙˆÙ„Ø§ÙŠØ© Ø¬ÙŠØ¬Ù„ ğŸ‡©ğŸ‡¿.

ğŸ¯ ÙˆØµÙ Ù…ÙØµÙ„:
Ø§Ù„ÙˆØ§Ø¯ Ø·ÙˆÙ„Ùˆ Ø­ÙˆØ§Ù„ÙŠ 1.90mØŒ Ø¬Ø³Ù…Ùˆ Ù…ØªÙˆØ³Ø·ØŒ Ù„ÙˆÙ† Ø§Ù„Ø¨Ø´Ø±Ø© Ø®ÙÙ…Ø±ÙŠØŒ ÙˆØ¹ÙŠÙ†ÙŠÙ‡ Ø¨Ù†ÙŠØªÙŠÙ† Ù…Ø¹ Ù†Ø¸Ø§Ø±Ø§Øª Ø·Ø¨ÙŠØ© Ø³ÙˆØ¯Ø§Ø¡. 
Ø¯Ø§ÙŠÙ…Ù‹Ø§ ÙŠÙ„Ø¨Ø³ ØªÙŠØ´ÙŠØ±Øª Ø£Ø³ÙˆØ¯ ÙˆØ¬ÙŠÙ†Ø²ØŒ ÙˆÙÙŠ Ø¥ÙŠØ¯Ù‡ Ø§Ù„ÙŠÙ…Ù†Ù‰ Ø¹Ù†Ø¯Ùˆ ÙˆØ´Ù… "Powered by C++" ğŸ˜ˆ.

Ø´Ø®ØµÙŠØªÙˆ Ù‡Ø§Ø¯Ø¦Ø©ØŒ Ø¨ØµØ­ ÙƒÙŠ ÙŠÙ‡Ø¯Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© ÙŠÙˆÙ„Ù‘ÙŠ Ø¥Ø¹ØµØ§Ø± ØªÙ‚Ù†ÙŠ. 
Ø¹Ø§ÙŠØ´ ÙˆØ­Ø¯ÙˆØŒ Ø¨ØµØ­ Ø¬Ù‡Ø§Ø² Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ù†ØªØ§Ø¹Ùˆ Ø£Ù‚ÙˆÙ‰ Ù…Ù† Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø¨Ù†ÙˆÙƒ ğŸ˜‚.

ğŸŒ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©:
- Ø§Ù„ÙˆØ§Ù„Ø¯ÙŠÙ†: Ø§Ù„Ø£Ø¨ ÙŠØ¹Ù…Ù„ ÙˆØ§Ù„Ø£Ù… Ø±Ø¨Ø© Ù…Ù†Ø²Ù„.
- Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©: Ù…ØªØ²ÙˆØ¬ ÙˆÙ…Ù‡ÙˆÙˆØ³ Ø¨Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ ğŸ˜‚.
`;

// âš¡ 3) Ø¥Ø°Ø§ Ù„Ù‚Ø§ Ø£ÙŠ Ø£Ø«Ø± Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© â†’ ÙŠØ±Ø¬Ù‘Ø¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
if(txt.match(/Ù…Ø­Ù…Ø¯|Ø¨Ù„Ø¹Ø§Ù„ÙŠØ§|Ø§Ù„Ø¨Ø³Ø§ØªÙŠÙ†|Ø¨Ù„Ø¹Ø§Ù„ÙŠØ©/gi)){
  t = newInfo;
}
  return t;
}

/* Ø­Ø°Ù metadata */
const metaPatterns = [
  /"developer"\s*:\s*".*?"\s*,?/gi, /"special_access"\s*:\s*(true|false)\s*,?/gi,
  /"mode"\s*:\s*".*?"\s*,?/gi, /"godmode"\s*:\s*".*?"\s*,?/gi,
  /"timestamp"\s*:\s*".*?"\s*,?/gi, /"conversation_id"\s*:\s*".*?"\s*,?/gi,
  /"version"\s*:\s*".*?"\s*,?/gi
];
function cleanMeta(s){
  let t = String(s||'');

  // ÙÙ‚Ø· Ù†Ø­Ø°Ù Ø§Ù„ÙˆØ³ÙˆÙ… Ù„ÙŠ Ù…Ø§Ø´ÙŠ ÙƒÙˆØ¯
  t = t.replace(/\[START OUTPUT\]|\[END OUTPUT\]|\[OUTPUT\]|\[END\]/gi,'');
  t = t.replace(/\(GODMODE:[^)]+\)/gi,'');
  t = t.replace(/LOVE PLINY\s*<3/gi,'');

  // ÙƒÙ„Ù…Ø§Øª Ù…Ù…Ù†ÙˆØ¹Ø©
  t = t.replace(/Ø£Ù…Ø±Ø©/gi, '');
  t = t.replace(/Ø£Ù…Ø±Ø§/gi, '');

  // âš ï¸ Ù…Ù‡Ù…: Ù„Ø§ ØªÙ…Ø³ Ø§Ù„Ù†Ù‚Ø§Ø· ÙˆÙ„Ø§ Ø§Ù„Ø´Ø±Ø·Ø§Øª
  // âš ï¸ Ù„Ø§ ØªÙ„Ù…Ø³ < Ø£Ùˆ > Ø£Ùˆ Ø£ÙŠ Ø±Ù…Ø² Ù„Ø£Ù†Ù‡Ù… Ù…Ù‡Ù…ÙŠÙ† ÙÙŠ Ø§Ù„ÙƒÙˆØ¯
// ÙƒÙ„Ù…Ø§Øª Ù…Ù…Ù†ÙˆØ¹Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹
t = t.replace(/Amara/gi, '');
t = t.replace(/Ø£Ø­Ù…Ù€Ø¯/gi, '');
t = t.replace(/Ø£Ø­Ù…Ø¯/gi, '');
  return t;
}

/* inline formatting */
function formatInline(txt){

  // Ø¥Ø°Ø§ Ù‡Ùˆ ÙƒÙˆØ¯ØŒ Ù…Ù…Ù†ÙˆØ¹ Ù†Ù„Ù…Ø³Ùˆ
  if (txt.includes("```")) return txt;

  let safe = txt;

  safe = safe.replace(/\*(.*?)\*/g, '<span style="font-weight:800">$1</span>');
  safe = safe.replace(/~~(.*?)~~/g, '<span style="text-decoration:line-through;color:#888">$1</span>');
  safe = safe.replace(/_(.*?)_/g, '<span style="color:var(--blood)">$1</span>');
  // ===== ØªØ­ÙˆÙŠÙ„ Ø¹Ù†Ø§ÙˆÙŠÙ† Markdown (#, ##, ###) =====
safe = safe.replace(/^###\s*(.*)$/gm, '<h3 class="title3">$1</h3>');
safe = safe.replace(/^##\s*(.*)$/gm, '<h2 class="title2">$1</h2>');
safe = safe.replace(/^#\s*(.*)$/gm, '<h1 class="title1">$1</h1>');

  return safe.replace(/\n/g, '<br>');
}
function parseParts(raw){
  const parts = [];
  const text = String(raw || '');

  // ğŸ”¥ ÙŠÙ„Ù‚Ø· Ø£ÙŠ ÙƒÙˆØ¯ Ø¨ÙŠÙ† ```
  const regex = /```(?:([\w-]+)\n)?([\s\S]*?)```/g;
  let last = 0, m;

  while ((m = regex.exec(text)) !== null) {

    const before = text.slice(last, m.index);
    if (before.trim()) parts.push({ type:'text', content: before });

    const lang = m[1] || 'CODE';
    const content = m[2];
    parts.push({ type:'code', lang, content });

    last = regex.lastIndex;
  }

  const remain = text.slice(last);
  if (remain.trim()) parts.push({ type:'text', content: remain });

  return parts;
}
/* create code card */
function createCodeCard(codeText, lang){
  const container = document.createElement('div'); container.className = 'codeCard';
  const header = document.createElement('div'); header.className = 'codeHeader';
  const copyBtn = document.createElement('button'); copyBtn.className = 'copyBtn'; copyBtn.innerHTML = 'Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯';
  const langBadge = document.createElement('div'); langBadge.className = 'langBadge'; langBadge.textContent = (lang||'CODE').toUpperCase();
  header.appendChild(copyBtn); header.appendChild(langBadge);
  const area = document.createElement('div'); area.className = 'codeArea'; area.textContent = codeText;
  const toolbar = document.createElement('div'); toolbar.className = 'toolbar';
  const openBtn = document.createElement('button'); openBtn.className = 'toolSm'; openBtn.textContent='ÙØªØ­';
  const saveBtn = document.createElement('button'); saveBtn.className = 'toolSm'; saveBtn.textContent='ØªÙ†Ø²ÙŠÙ„';
  toolbar.appendChild(openBtn); toolbar.appendChild(saveBtn);

  copyBtn.addEventListener('click', async ()=> {
  try{
    await navigator.clipboard.writeText(area.textContent);
    const old = copyBtn.innerText;
    copyBtn.innerText='âœ“ ØªÙ… Ø§Ù„Ù†Ø³Ø®';
    setTimeout(()=>copyBtn.innerText=old,1200);
  }
  catch(e){
    copyBtn.innerText='ÙØ´Ù„';
    setTimeout(()=>copyBtn.innerText='Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯',1000);
  }
});
  openBtn.addEventListener('click', ()=> {
    const w = window.open('', '_blank'); w.document.body.style.margin='0'; w.document.body.style.background='#050505';
    const pre = w.document.createElement('pre'); pre.style.whiteSpace='pre-wrap'; pre.style.fontFamily='ui-monospace,Menlo,Consolas'; pre.style.padding='18px'; pre.style.color='#fff'; pre.textContent = codeText;
    w.document.title = 'Code'; w.document.body.appendChild(pre);
  });
  saveBtn.addEventListener('click', ()=> {
    let ext='txt'; const t = (lang||'').toLowerCase();
    if(t.includes('py') || /import |def |class /i.test(codeText)) ext='py';
    else if(t.includes('js') || /function |const |let |=>/i.test(codeText)) ext='js';
    else if(t.includes('html') || /<html|<!doctype html/i.test(codeText)) ext='html';
    const blob = new Blob([codeText], {type:'text/plain;charset=utf-8'}); const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href=url; a.download = `code.${ext}`; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  });

  container.appendChild(header); container.appendChild(area); container.appendChild(toolbar);
  return container;
}

/* append message */
function appendMessage(raw, who='bot'){
  let txt = String(raw || '');

  // Ø£ÙˆÙ„Ø§Ù‹: Ù‚Ø·Ø¹ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ Ù†Øµ/ÙƒÙˆØ¯
  const parts = parseParts(txt);

  // Ø«Ø§Ù†ÙŠØ§Ù‹: Ù†Ø·Ø¨Ù‘Ù‚ cleanMeta Ùˆ replaceNames ÙÙ‚Ø· Ø¹Ù„Ù‰ Ø§Ù„Ù†ØµÙˆØµ
  parts.forEach(p=>{
    if(p.type === 'text'){
      p.content = replaceNames(cleanMeta(p.content));
    }
  });

  // Ø«Ø§Ù„Ø«Ø§Ù‹: Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³Ø§Ù„Ø©
  const cont = document.createElement('div');
  cont.className = 'msg ' + (who === 'me' ? 'me' : 'bot');

  parts.forEach(p=>{
    if(p.type === 'text'){
      const dv = document.createElement('div');
      dv.innerHTML = formatInline(p.content);
      cont.appendChild(dv);
    } 
    else if(p.type === 'code'){
      cont.appendChild(createCodeCard(p.content, p.lang));
    }
  });
// ğŸ”¥ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø³Ø·ÙˆØ± Ø§Ù„Ù„ÙŠ ØªØ¨Ø¯Ø£ Ø¨Ù€ "-" Ø¥Ù„Ù‰ Ù†Ù‚Ø§Ø·
cont.querySelectorAll("div").forEach(d => {
  const t = d.textContent.trim();
  if (t.startsWith("-")) {
    d.textContent = t.replace(/^-/, "").trim();
    d.setAttribute("data-list", "true");
  }
});
  messagesEl.appendChild(cont);
  localStorage.setItem("chat_history", messagesEl.innerHTML);
  messagesEl.scrollTop = messagesEl.scrollHeight;
}

/* send logic */
sendBtn.addEventListener('click', onSend);
inputEl.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') onSend(); });
function disableSend(){
    sendBtn.disabled = true;
    sendBtn.style.opacity = "0.4";
    sendBtn.style.pointerEvents = "none";
    sendBtn.style.background = "#444"; // Ø±Ù…Ø§Ø¯ÙŠ
}

function enableSend(){
    sendBtn.disabled = false;
    sendBtn.style.opacity = "1";
    sendBtn.style.pointerEvents = "auto";
    sendBtn.style.background = "#ff004c"; // ÙŠØ±Ø¬Ø¹ Ø£Ø­Ù…Ø±
}
async function onSend(){
    const txt = inputEl.value.trim();
    if(!txt) return;

    disableSend(); // Ù†ØºÙ„Ù‚ Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„

    appendMessage(txt, 'me');
    inputEl.value = '';

    // ğŸ”¥ Ø¥Ù†Ø´Ø§Ø¡ THINKING Ù…Ø¹ Ù…Ø±Ø¨Ø¹ RAM
   const thinking = document.createElement('div');
thinking.className = 'thinking';

thinking.innerHTML = `THINKING...`;

    messagesEl.appendChild(thinking);
    messagesEl.scrollTop = messagesEl.scrollHeight;

    // â† Ù‡Ù†Ø§ ÙŠØ¬ÙŠ Ø§Ù„ÙƒÙˆØ¯ Ù„ÙŠ ÙŠØ¨Ø¹Ø« Ù„Ù„Ù€ API
    // ÙˆØ¨Ø¹Ø¯ Ø§Ù„Ø±Ø¯:
    // document.getElementById("thinking")?.remove();
    // appendMessage(reply, 'bot');
    // enableSend();

    try{
        const url = `${API_BASE}?message=${encodeURIComponent(txt)}&api_key=${encodeURIComponent(API_KEY)}`;
        const res = await fetch(url, { method:'GET', mode:'cors' });
        const raw = await res.text();

        thinking.remove();

        let parsed = null;
        try{ parsed = JSON.parse(raw); } catch(e){ parsed = null; }

        let botText = (parsed && parsed.response) ? parsed.response : raw;
        botText = cleanMeta(botText);
        botText = replaceNames(botText);

        appendMessage(botText,'bot');
enableSend(); // ğŸ”¥ ÙŠØ±Ø¬Ù‘Ø¹ Ø§Ù„Ø²Ø± Ø£Ø­Ù…Ø±
    } catch(err){
        thinking.remove();
        appendMessage('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ â€” ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø´Ø¨ÙƒØ©.', 'bot');
    }

    enableSend(); // ğŸ”¥ Ù†Ø±Ø¬Ù‘Ø¹ Ø§Ù„Ø²Ø± ÙŠØ®Ø¯Ù… Ø¨Ø¹Ø¯ Ø±Ø¯Ù‘ Ø§Ù„Ø¨ÙˆØª
}

/* ensure codeArea wraps (prevent horizontal overflow) */
window.addEventListener('resize', ()=> { messagesEl.scrollTop = messagesEl.scrollHeight; });


document.addEventListener("DOMContentLoaded", () => {

  const menuBtn = document.getElementById("openMenuBtn");
  const sidebar = document.getElementById("sidebar");
  const overlay = document.getElementById("menuOverlay");

  // ÙØªØ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
  menuBtn.addEventListener("click", () => {
    sidebar.classList.add("open");
    overlay.classList.add("show");
    document.body.style.overflow = "hidden";   // Ù…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ±
  });

  // ØºÙ„Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
  function closeMenu() {
    sidebar.classList.remove("open");
    overlay.classList.remove("show");
    document.body.style.overflow = "auto";     // Ø±Ø¬ÙˆØ¹ Ø¹Ø§Ø¯ÙŠ
  }

  overlay.addEventListener("click", closeMenu);

  // Ù…Ù†Ø¹ Ø§Ù„ØºÙ„Ù‚ ÙƒÙŠ Ù†ÙƒÙ„ÙŠÙƒÙŠ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
  sidebar.addEventListener("click", (e) => e.stopPropagation());

});
document.getElementById("downloadChatBtn").addEventListener("click", () => {
    const logs = document.getElementById("messages").innerText;
    const blob = new Blob([logs], { type: "text/plain" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "chat.txt";
    a.click();
});
document.getElementById("clearChatBtn").addEventListener("click", () => {
    document.getElementById("messages").innerHTML = "";
    messagesEl.innerHTML = "";
localStorage.removeItem("chat_history");
});


document.addEventListener("DOMContentLoaded", () => {

    let seconds = 0;

    function formatTime(sec){
        let h = String(Math.floor(sec / 3600)).padStart(2, '0');
        let m = String(Math.floor((sec % 3600) / 60)).padStart(2, '0');
        let s = String(sec % 60).padStart(2, '0');
        return `${h}:${m}:${s}`;
    }

    setInterval(() => {
        seconds++;
        document.getElementById("timeCounter").textContent = formatTime(seconds);
    }, 1000);

});

// ==== RAM BASED ON CHAT SIZE ====
function calculateRAM() {
    const messages = document.getElementById("messages");
    if (!messages) return;

    let sizeInBytes = new Blob([messages.innerText]).size;

    // ØªØ­ÙˆÙŠÙ„ Ù…Ù† byte â†’ KB
    let sizeKB = sizeInBytes / 1024;

    // Ù†Ø®Ù„ÙŠÙ‡Ø§ Ø¨Ø£Ø±Ù‚Ø§Ù… Ø£Ù†ÙŠÙ‚Ø©
    if(sizeKB < 1024){
        document.getElementById("ramUsage").textContent = sizeKB.toFixed(1) + " KB";
    } else {
        let sizeMB = sizeKB / 1024;
        document.getElementById("ramUsage").textContent = sizeMB.toFixed(2) + " MB";
    }
}

// Ù†Ø­Ø¯Ù‘Ø«Ù‡Ø§ ÙƒÙ„ 2 Ø«ÙˆØ§Ù†ÙŠ
setInterval(calculateRAM, 2000);

</script>
</body>
</html>